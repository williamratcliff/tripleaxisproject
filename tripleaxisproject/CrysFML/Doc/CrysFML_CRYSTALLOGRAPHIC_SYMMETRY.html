<html>
  <head>
    <title> CrysFML </title>
  </head>
  <body bgcolor="#FFFFCC">
    <h2> <a name="mod17" > CRYSTALLOGRAPHIC_SYMMETRY </a> </h2>                                                                                           
    <dd>  This module constains everything needed for handling symmetry                                                                                   
    in Crystallography. Part of the information is obtained from                                                                                          
    tabulated items in the module Symmetry_Tables. In particular                                                                                          
    the correspondence of non standard settings Hermann-Mauguin                                                                                           
    symbols and Hall symbols for space groups.                                                                                                            
    The generation of the public type Space_Group_Type is done                                                                                            
    using a variety of algorithms and methods.                                                                                                            
    Many procedures for handling symmetry (symbolic and algebraic)                                                                                        
    are provided in this module. </dd>                                                                                                                    
    <dd> <p> <b> <i> Variables </i> </b> </p> </dd>                                                                                                       
    <ul>                                                                                                                                                  
      <li> <a href="#var20" > CUBIC </a> </li>                                                                                                            
      <li> <a href="#var21" > ERR_MESS_SYMM </a> </li>                                                                                                    
      <li> <a href="#var22" > ERR_SYMM </a> </li>                                                                                                         
      <li> <a href="#var23" > HEXA </a> </li>                                                                                                             
      <li> <a href="#var24" > HEXAG </a> </li>                                                                                                            
      <li> <a href="#var25" > INLAT </a> </li>                                                                                                            
      <li> <a href="#var26" > LAT_TYPE </a> </li>                                                                                                         
      <li> <a href="#var27" > LTR </a> </li>                                                                                                              
      <li> <a href="#var28" > MONOC </a> </li>                                                                                                            
      <li> <a href="#var29" > NLAT </a> </li>                                                                                                             
      <li> <a href="#var30" > NUM_SPGR_INFO </a> </li>                                                                                                    
      <li> <a href="#var31" > ORTOR </a> </li>                                                                                                            
      <li> <a href="#var32" > SPACEG </a> </li>                                                                                                           
      <li> <a href="#var33" > SYM_OPER_TYPE </a> </li>                                                                                                    
      <li> <a href="#var34" > WYCK_POS_TYPE </a> </li>                                                                                                    
      <li> <a href="#var35" > WYCKOFF_TYPE </a> </li>                                                                                                     
      <li> <a href="#var36" > SPACE_GROUP_TYPE </a> </li>                                                                                                 
      <li> <a href="#var37" > TETRA </a> </li>                                                                                                            
      <li> <a href="#var38" > TRIGO </a> </li>                                                                                                            
    </ul>                                                                                                                                                 
    <dd> <p> <b> <i> Functions </i> </b> </p> </dd>                                                                                                       
    <ul>                                                                                                                                                  
      <li> <a href="#fun11" > APPLYSO </a> </li>                                                                                                          
      <li> <a href="#fun12" > AXES_ROTATION </a> </li>                                                                                                    
      <li> <a href="#fun13" > GET_LAUE_NUM </a> </li>                                                                                                     
      <li> <a href="#fun14" > GET_MULTIP_POS </a> </li>                                                                                                   
      <li> <a href="#fun15" > GET_OCC_SITE </a> </li>                                                                                                     
      <li> <a href="#fun16" > GET_POINTGROUP_NUM </a> </li>                                                                                               
      <li> <a href="#fun17" > IS_NEW_OP </a> </li>                                                                                                        
      <li> <a href="#fun18" > LATTICE_TRANS </a> </li>                                                                                                    
      <li> <a href="#fun19" > SPGR_EQUAL </a> </li>                                                                                                       
      <li> <a href="#fun20" > SYM_PROD </a> </li>                                                                                                         
    </ul>                                                                                                                                                 
    <dd> <p> <b> <i> Subroutines </i> </b> </p> </dd>                                                                                                     
    <ul>                                                                                                                                                  
      <li> <a href="#sub40" > DECODMATMAG </a> </li>                                                                                                      
      <li> <a href="#sub41" > GET_CENTRING_VECTORS </a> </li>                                                                                             
      <li> <a href="#sub42" > GET_CRYSTAL_SYSTEM </a> </li>                                                                                               
      <li> <a href="#sub43" > GET_HALLSYMB_FROM_GENER </a> </li>                                                                                          
      <li> <a href="#sub44" > GET_LATTICE_TYPE </a> </li>                                                                                                 
      <li> <a href="#sub45" > GET_LAUE_PG </a> </li>                                                                                                      
      <li> <a href="#sub46" > GET_LAUE_STR </a> </li>                                                                                                     
      <li> <a href="#sub47" > GET_ORBIT </a> </li>                                                                                                        
      <li> <a href="#sub48" > GET_POINTGROUP_STR </a> </li>                                                                                               
      <li> <a href="#sub49" > GET_SO_FROM_FIX </a> </li>                                                                                                  
      <li> <a href="#sub50" > GET_SO_FROM_GENER </a> </li>                                                                                                
      <li> <a href="#sub51" > GET_SO_FROM_HALL </a> </li>                                                                                                 
      <li> <a href="#sub52" > GET_SO_FROM_HMS </a> </li>                                                                                                  
      <li> <a href="#sub53" > GET_STABILIZER </a> </li>                                                                                                   
      <li> <a href="#sub54" > GET_STRING_RESOLV </a> </li>                                                                                                
      <li> <a href="#sub55" > GET_SUBORBITS </a> </li>                                                                                                    
      <li> <a href="#sub56" > GET_SYMEL </a> </li>                                                                                                        
      <li> <a href="#sub57" > GET_SYMKOV </a> </li>                                                                                                       
      <li> <a href="#sub58" > GET_SYMSYMB </a> </li>                                                                                                      
      <li> <a href="#sub59" > GET_T_SUBGROUPS </a> </li>                                                                                                  
      <li> <a href="#sub60" > INIT_ERR_SYMM </a> </li>                                                                                                    
      <li> <a href="#sub61" > INVERSE_SYMM </a> </li>                                                                                                     
      <li> <a href="#sub62" > LATSYM </a> </li>                                                                                                           
      <li> <a href="#sub63" > READ_MSYMM </a> </li>                                                                                                       
      <li> <a href="#sub64" > READ_SYMTRANS_CODE </a> </li>                                                                                               
      <li> <a href="#sub65" > READ_XSYM </a> </li>                                                                                                        
      <li> <a href="#sub66" > SEARCHOP </a> </li>                                                                                                         
      <li> <a href="#sub67" > SET_SPACEGROUP </a> </li>                                                                                                   
      <li> <a href="#sub68" > SET_SPG_MULT_TABLE </a> </li>                                                                                               
      <li> <a href="#sub69" > SETTING_CHANGE </a> </li>                                                                                                   
      <li> <a href="#sub70" > SIMILAR_TRANSF_SG </a> </li>                                                                                                
      <li> <a href="#sub71" > SYM_B_RELATIONS </a> </li>                                                                                                  
      <li> <a href="#sub72" > SYM_PROD_ST </a> </li>                                                                                                      
      <li> <a href="#sub73" > SYMMETRY_SYMBOL </a> </li>                                                                                                  
      <li> <a href="#sub74" > WRITE_SPACEGROUP </a> </li>                                                                                                 
      <li> <a href="#sub75" > WRITE_SYM </a> </li>                                                                                                        
      <li> <a href="#sub76" > WRITE_SYMTRANS_CODE </a> </li>                                                                                              
      <li> <a href="#sub77" > WRITE_WYCKOFF </a> </li>                                                                                                    
      <li> <a href="#sub78" > WYCKOFF_ORBIT </a> </li>                                                                                                    
    </ul>                                                                                                                                                 
    </dl>                                                                                                                                                 
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var1"  > CUBIC </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Cubic                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Cubic parameter index: Cubic = 554                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var2"  > ERR_MESS_SYMM </a> </h4>                                                                                                       
    <p> <pre>                                                                                                                                             
        character(len=150), public :: Err_Mess_Symm                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    String containing information about the last error                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var3"  > ERR_SYMM </a> </h4>                                                                                                            
    <p> <pre>                                                                                                                                             
        logical, public :: Err_Symm                                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Logical Variable to indicate an error on this module.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var4"  > HEXA </a> </h4>                                                                                                                
    <p> <pre>                                                                                                                                             
        logical, public :: Hexa                                                                                                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    .false. Rotational part of symmetry operators  belongs to m3m                                                                                         
    .true.  Rotational part of symmetry operators  belongs to 6/mmm                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var5"  > HEXAG </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Hexag                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for hexagonal Groups: Hexag  = 527                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var6"  > INLAT </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, public        :: Inlat                                                                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Ordinal index of the lattice                                                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var7"  > LAT_TYPE </a> </h4>                                                                                                            
    <p> <pre>                                                                                                                                             
        character(len= 1), public     :: Lat_type                                                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    First character of the space group symbol                                                                                                             
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var8"  > LTR </a> </h4>                                                                                                                 
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3,10), public  :: Ltr                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Centering Lattice Translations, up to 10 lattice centring                                                                                             
    vectors are allowed. Conventional lattice centring need only 4 vectors                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var9"  > MONOC </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Monoc                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Monoclinic Groups: Monoc  =  15                                                                                                   
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var10" > NLAT </a> </h4>                                                                                                                
    <p> <pre>                                                                                                                                             
        integer, public      :: Nlat                                                                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Multiplicity of the lattice                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var11" > NUM_SPGR_INFO </a> </h4>                                                                                                       
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Num_Spgr_Info                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Total dimension of SPGR_INFO: Num_Spgr_Info = 612                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var12" > ORTOR </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Ortor                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Orthorhombic Groups: Ortor  = 163                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var13" > SPACEG </a> </h4>                                                                                                              
    <p> <pre>                                                                                                                                             
         character(len=20), public     :: SpaceG                                                                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Space group symbol                                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var14" > TYPE :: SYM_OPER_TYPE </a> </h4>                                                                                               
    <p> <pre>                                                                                                                                             
     Type, public :: Sym_Oper_Type                                                                                                                        
        integer,       dimension(3,3) :: Rot     !  Rotational Part of Symmetry Operator                                                                  
        real(kind=sp), dimension(3)   :: Tr      !  Traslational part of Symmetry Operator                                                                
     End Type  Sym_Oper_Type                                                                                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var15" > TYPE :: WYCK_POS_TYPE </a> </h4>                                                                                               
    <p> <pre>                                                                                                                                             
     Type, public :: Wyck_Pos_Type                                                                                                                        
        integer                         :: multp     ! Multiplicity                                                                                       
        character(len= 6)               :: site      ! Site Symmetry                                                                                      
        integer                         :: norb      ! Number of elements in orbit                                                                        
        character(len=40)               :: orig      ! Orig                                                                                               
        character(len=40),dimension(48) :: str_orbit ! Orbit                                                                                              
        character(len=40),dimension(192):: extra_orbit                                                                                                    
     End Type Wyck_Pos_Type                                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var16" > TYPE :: WYCKOFF_TYPE </a> </h4>                                                                                                
    <p> <pre>                                                                                                                                             
     Type, public :: Wyckoff_Type                                                                                                                         
        integer                            :: num_orbit      ! Number of orbits                                                                           
        type(wyck_pos_type), dimension(26) :: orbit          ! Orbit type                                                                                 
     End Type Wyckoff_Type                                                                                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var17" > TYPE :: SPACE_GROUP_TYPE </a> </h4>                                                                                            
    <p> <pre>                                                                                                                                             
     Type, public :: Space_Group_Type                                                                                                                     
        Integer                            :: NumSpg        ! Number of the Space Group                                                                   
        Character(len=20)                  :: SPG_Symb      ! Hermann-Mauguin Symbol                                                                      
        Character(len=16)                  :: Hall          ! Hall symbol                                                                                 
        Character(len=12)                  :: CrystalSys    ! Crystal system                                                                              
        Character(len= 5)                  :: Laue          ! Laue Class                                                                                  
        Character(len= 5)                  :: PG            ! Point group                                                                                 
        Character(len= 5)                  :: Info          ! Extra information                                                                           
        Character(len=80)                  :: SG_setting    ! Information about the SG setting                                                            
                                                            ! (IT,KO,ML,ZA,Table,Standard,UnConventional)                                                 
        Logical                            :: Hexa          !                                                                                             
        Character(len= 1)                  :: SPG_lat       ! Lattice type                                                                                
        Character(len= 2)                  :: SPG_latsy     ! Lattice type Symbol                                                                         
        Integer                            :: NumLat        ! Number of lattice points in a cell                                                          
        real(kind=sp), dimension(3,12)     :: Latt_trans    ! Lattice translations                                                                        
        Character(len=51)                  :: Bravais       ! String with Bravais symbol + translations                                                   
        Character(len=80)                  :: Centre        ! Information about Centric or Acentric                                                       
        Integer                            :: Centred       ! =0 Centric(-1 no at origin)                                                                 
                                                            ! =1 Acentric                                                                                 
                                                            ! =2 Centric(-1 at origin)                                                                    
        real(kind=sp), dimension(3)        :: Centre_coord  ! Fractional coordinates of the inversion centre                                              
        Integer                            :: NumOps        ! Number of reduced set of S.O.                                                               
        Integer                            :: Multip        ! Multiplicity of the general position                                                        
        Integer                            :: Num_gen       ! Minimum number of operators to generate the Group                                           
        type(Sym_Oper_Type), dimension(192):: SymOp         ! Symmetry operators                                                                          
        Character(len=40), dimension(192)  :: SymopSymb     ! Strings form of symmetry operators                                                          
        type(wyckoff_type)                 :: Wyckoff       ! Wyckoff Information                                                                         
        real(kind=sp), dimension(3,2)      :: R_Asym_Unit   ! Asymmetric unit in real space                                                               
     End Type Space_Group_Type                                                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of a variable type Space_Group_Type                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var18" > TETRA </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Tetra                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Tetragonal Groups: Tetra = 410                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var19" > TRIGO </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Trigo                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Trigonal Groups: Trigo = 495                                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var20" > Function Applyso(Op,V) Result(Applysop) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        Type(Sym_Oper_Type),          intent(in) :: Op        !  In -> Symmetry Operator Type                                                             
        real(kind=sp), dimension(3) , intent(in) :: v         !  In -> Vector                                                                             
        real(kind=sp), dimension(3)              :: ApplySOp  ! Out -> Output vector                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Apply a symmetry operator to a vector:  Vp = ApplySO(Op,v)                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var21" > Function Axes_Rotation(R) Result(N) </a> </h4>                                                                                 
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3,3), intent  (in) :: r    !  In -> Rotation part of Symmetry Operator                                                   
        integer                                     :: n    ! Out -> Orden of the Rotation Part                                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine the orden of rotation (valid for all bases). Return a zero                                                                                  
    if any error occurs.                                                                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var22" > Function Get_Laue_Num(Laueclass) Result(Lnum) </a> </h4>                                                                       
    <p> <pre>                                                                                                                                             
        character(len=*), intent (in) :: laueclass    !  In -> Laue Class string                                                                          
        integer                       :: lnum         ! Out -> Ordinal number according LAUE_CLASS                                                        
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the ordinal number corresponding to the Laue-Class                                                                                             
    symbol according to Laue_Class array. Zero if error is present                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var23" > Function Get_Multip_Pos(X,Spg) Result(Mult) </a> </h4>                                                                         
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent (in) :: x        !  In -> Position vector                                                                     
        type(Space_Group_type),      intent (in) :: spgr     !  In -> Space Group                                                                         
        integer                                  :: mult     !  Result -> Multiplicity                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity of a real space point given the space group.                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var24" > Function Get_Occ_Site(Pto,Spg) Result(Occ) </a> </h4>                                                                          
    <p> <pre>                                                                                                                                             
        real(kind=sp),dimension(3),intent (in) :: Pto ! Point for Occupancy calculation                                                                   
        Type (Space_Group_Type),   intent(in)  :: Spg ! Space Group                                                                                       
        real(kind=sp)                          :: Occ ! Result                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the occupancy factor (site multiplicity/multiplicity) for Pto                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var25" > Function Get_Pointgroup_Num(Pgname) Result(Ipg) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        character(len=*), intent (in) :: pgname        !  In -> String for PointGroup                                                                     
        integer                       :: ipg           ! Out -> Ordinal number as POINT_GROUP                                                             
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the ordinal number corresponding to the Point Group                                                                                            
    symbol according to Point_Group array. Zero if Error is present                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var26" > Logical Function Is_New_Op(Op,N,List_Op) Result(Is_New) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_type), intent(in)               :: op      !  In ->  Symmetry operator                                                              
        Integer,             intent(in)               :: n       !  In ->  Integer giving the number of Op i the list                                     
        type(Sym_Oper_type), intent(in), dimension(:) :: list_op !  In ->  List of n symmetry operators                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine if a symmetry operator is or not in a given list                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var27" > Logical Function Lattice_Trans(V,Lat) Result(Lattice_Transl) </a> </h4>                                                        
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent( in) :: v              !  In -> Vector                                                                        
        character(len=*),            intent( in) :: Lat            !  In -> Lattice Character                                                             
        logical                                  :: Lattice_Transl ! Out -> .True. or .False.                                                             
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine whether a vector is a lattice vector                                                                                                        
    depending on the Bravais lattice.                                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var28" > Logical Function Spgr_Equal(Spacegroup1,Spacegroup2) Result(Ispgr_Equal) </a> </h4>                                            
    <p> <pre>                                                                                                                                             
        Type (Space_Group_Type),  intent(in) :: SpaceGroup1   ! In ->                                                                                     
        Type (Space_Group_Type),  intent(in) :: SpaceGroup2   ! In ->                                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine if two SpaceGroups are equal                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var29" > Function Sym_Prod(Syma,Symb,Modlat) Result (Symab) </a> </h4>                                                                  
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_Type), intent (in) :: syma                                                                                                          
        type(Sym_Oper_Type), intent (in) :: symb                                                                                                          
        logical,optional,    intent (in) :: modlat                                                                                                        
        type(Sym_Oper_Type)              :: symab                                                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the symmetry operation corresponding to the product of                                                                                         
    two operators.                                                                                                                                        
    If modlat=.true. or it is not present, the traslation                                                                                                 
    part of the resulting operator is reduced to have components <1.0                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var30" > Subroutine Decodmatmag(Sim,Xyzstring) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent(in)  :: sim          !  In -> Rotation matrix                                                                     
        character (len=*),       intent(out) :: XYZstring    ! Out -> String (Mx,My,Mz)                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string of the form (Mx,My,Mz) for the rotation matrix Sim.                                                                                 
    Logical "hexa" must be defined.                                                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var31" > Subroutine Get_Centring_Vectors(L,Latc) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        integer,                        intent (in out) :: L     ! Number of centring vectors                                                             
        real(kind=sp), dimension(:,:),  intent (in out) :: latc  ! Centering vectors                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to complete the centring vectors of a centered lattice                                                                                     
    It is useful when non-conventional lattices are used.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var32" > Subroutine Get_Crystal_System(Ng, Ss / Gen, Isystm, Crys) </a> </h4>                                                           
    <p> <pre>                                                                                                                                             
        integer,                      intent(in) :: Ng     !  In -> Number of Operators (not related by                                                   
                                                                    inversion and lattice traslations)                                                    
        integer, dimension(:,:,:),    intent(in) :: Ss     !  In -> Rotation Part   (3,3,48)                                                              
        or                                                                                                                                                
        character(len=*),dimension(:),intent(in) :: gen    !  In -> Jones Faithful form of symmetry operators                                             
        integer,                      intent(out):: ISystm ! Out -> Number for Crystal System                                                             
                                                                     1: Triclinic       2: Monoclinic                                                     
                                                                     3: Orthorrombic    4: Tetragonal                                                     
                                                                     5: Trigonal        6: Hexagonal                                                      
                                                                     7: Cubic                                                                             
        character(len=1),             intent(out):: Crys   ! Out -> Symbol of Crystal family                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the number and string of the Crystal System from a set of operators                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var33" > Subroutine Get_HallSymb_From_Gener(Spacegroup, Spaceh) </a> </h4>                                                              
    <p> <pre>                                                                                                                                             
        type(Space_Group_Type),   intent(in out) :: SpaceGroup   !  In -> SpaceGroup type variable                                                        
                                                                   Out -> SpaceGroup type variable                                                        
        character(len=*), intent(out), optional  :: SpaceH       ! Out -> Hall Symbol                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determines the Hall symbol. In general this routine try to obtain                                                                                     
    the Hall symbol from generators so you need call Get_So_from_Gener                                                                                    
    before and call Set_Spgr_Info.                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var34" > Subroutine Get_Lattice_Type(L, Latc, Lattyp) </a> </h4>                                                                        
    <p> <pre>                                                                                                                                             
        integer,                        intent(in)  :: L         !  number of centring vectors                                                            
        real(kind=sp), dimension(:,:),  intent(in)  :: Latc      ! (3,11) centring vectors                                                                
        character(len=*),               intent(out) :: lattyp    ! Lattice symbol                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get the lattice symbol from a set of centring vectors.                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var35" > Subroutine Get_Laue_Pg(Spacegroup, Laue_Car, Point_Car) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type),  intent( in) :: SpaceGroup   !  In -> Space Group type variable                                                          
        character(len=*),         intent(out) :: Laue_car     ! Out -> String with Laue symbol                                                            
        character(len=*),         intent(out) :: Point_car    ! Out -> String with Point Group symbol                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get the information of Laue and Point Group.                                                                                            
    Vvalid only for conventional bases for Point Group                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var36" > Subroutine Get_Laue_Str(Ilaue,Laue_Str) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        integer,          intent( in) :: ilaue         !  In -> Ordinal number in LAUE_CLASS                                                              
        character(len=*), intent(out) :: Laue_Str      ! Out -> String with the Laue class                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the string for the Laue-Class. Control of error is                                                                                             
    present                                                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var37" > Subroutine Get_Orbit(X,Spg,Mult,orb,ptr,str,prim) </a> </h4>                                                                   
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3),  intent (in) :: x     !  In -> Position vector                                                                       
        type(Space_Group_type),       intent (in) :: spgr  !  In -> Space Group                                                                           
        integer,                      intent(out) :: mult  !  Out -> Multiplicity                                                                         
        real, dimension(:,:),         intent(out) :: orb   !  Out -> List of equivalent positions                                                         
        integer,dimension(:),optional,intent(out) :: ptr   !  Out -> Pointer to effective symops                                                          
        integer,dimension(:),optional,intent(out) :: str   !  Out -> Pointer to stabilizer                                                                
        character(len=*),    optional,intent( in) :: prim  !  In  -> If given, only the primitive cell is considered                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity and list of equivalent positions                                                                                              
    (including centring!) modulo integer lattice translations.                                                                                            
    It provides also pointers to the stabilizer and to the                                                                                                
    symmetry operators changing effectively the position.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="var38" > Subroutine Get_Pointgroup_Str(Ipg,Str) </a> </h4>                                                                              
    <p> <pre>                                                                                                                                             
        integer,          intent( in) :: ipg        !  In -> Ordinal number for POINT_GROUP                                                               
        character(len=*), intent(out) :: Str        ! Out -> String for Point Group                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the string for the Point Group. Error control is present                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun1"  > Subroutine Get_So_From_Fix(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Spacegen) </a> </h4>                                         
    <p> <pre>                                                                                                                                             
        integer,                     intent(out) :: ISYSTM    ! Out -> Number of the crystalline system                                                   
                                                              ! Out    (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                            
        integer,                     intent(out) :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                       
                                                                       1 Acentric                                                                         
                                                                       2 Centric (-1 at origin)                                                           
        integer,                     intent(out) :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                                  
                                                                       1   2   3   4   5   6   7   8                                                      
                                                                       "P","A","B","C","I","R","F","Z"                                                    
        integer,                     intent(in ) :: NG        !  In -> Number of symmetry operators                                                       
        real(kind=sp),dimension(:,:),intent(in ) :: TS        !  In -> Translation parts of the symmetry operators(3,48)                                  
        integer, dimension(:,:,:),   intent(in ) :: SS        !  In -> Rotation parts of the symmetry operators (3,3,48)                                  
        character (len=2),           intent(out) :: latsy     ! Out -> Bravais Lattice symbol                                                             
        real(kind=sp),dimension(3)  ,intent(out) :: Co        ! Out -> Coordinates of origin                                                              
        character (len=1),           intent(out) :: SpaceGen  ! Out -> Type of Cell                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determines some of items of the object Space_Group_Type from FIXed                                                                                    
    symmetry operators given by user.                                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun2"  > Subroutine Get_So_From_Gener(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Num_G,Spacegen) </a> </h4>                                 
    <p> <pre>                                                                                                                                             
        integer,                      intent(out)   :: ISYSTM    ! Out -> Number of the crystalline system                                                
                                                                          (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                         
        integer,                      intent(out)   :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                    
                                                                          1 Acentric                                                                      
                                                                          2 Centric (-1 at origin)                                                        
        integer,                      intent(out)   :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                               
                                                                          1   2   3   4   5   6   7   8                                                   
                                                                          "P","A","B","C","I","R","F","Z"                                                 
        integer,                      intent(in out):: NG        !  In -> Number of defined generators                                                    
                                                                 ! Out -> Number of symmetry operators                                                    
        integer, dimension(:,:,:),    intent(in out):: SS        !  In -> Rotation parts of the given generators  (3,3,48)                                
                                                                 ! Out -> Rotation parts of the symmetry operators                                        
        real(kind=sp),dimension(:,:), intent(in out):: TS        !  In -> Translation parts of the given generators  (3,48)                               
                                                                 ! Out -> Translation parts of the symmetry operators                                     
        character (len=2),            intent(out)   :: latsy     ! Out -> Bravais Lattice symbol                                                          
        real(kind=sp),dimension(3),   intent(out)   :: Co        ! Out -> Coordinates of origin                                                           
        integer,                      intent(out)   :: Num_g     ! Out -> Minimum number of generators                                                    
        character (len=1),            intent(out)   :: SpaceGen  ! Out -> Type of Cell                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculates the whole set of symmetry operators from a set of given generators.                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun3"  > Subroutine Get_So_From_Hall(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Num_G,Hall) </a> </h4>                                      
    <p> <pre>                                                                                                                                             
        integer,                   intent(out)  :: ISYSTM    ! Out -> Number of the crystalline system                                                    
                                                                      (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                             
        integer,                   intent(out)  :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                        
                                                                      1 Acentric                                                                          
                                                                      2 Centric (-1 at origin)                                                            
        integer,                   intent(out)  :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                                   
                                                                      1   2   3   4   5   6   7                                                           
                                                                     "P","A","B","C","I","R","F"                                                          
        integer,                   intent(out)  :: NG        ! Out -> Number of symmetry operators                                                        
        real(kind=sp),    dimension(:,:),   intent(out)  :: TS        ! Out -> Translation parts of the symmetry operators  (3,48)                        
        integer, dimension(:,:,:), intent(out)  :: SS        ! Out -> Rotation parts of the symmetry operators     (3,3,48)                               
        character (len=2),         intent(out)  :: latsy     ! Out -> Bravais lattice symbol                                                              
        real(kind=sp), dimension(3),        intent(out)  :: Co        ! Out -> Coordinates of symmetry center                                             
        integer,                   intent(out)  :: num_g     ! Out -> Number of generators                                                                
        character (len=20),        intent( in)  :: Hall      !  In -> Hall Spacegroup symbol                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get all the information contained in the Hall symbol. This                                                                              
    routine to interpret the Hall symbol for a space group.                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun4"  > Subroutine Get_So_From_Hms(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Spaceh) </a> </h4>                                              
    <p> <pre>                                                                                                                                             
        integer,                        intent(out)  :: ISYSTM    ! Out -> Number of the crystalline system                                               
                                                                           (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                        
        integer,                        intent(out)  :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                   
                                                                           1 Acentric                                                                     
                                                                           2 Centric (-1 at origin)                                                       
        integer,                        intent(out)  :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                              
                                                                           1   2   3   4   5   6   7                                                      
                                                                          "P","A","B","C","F","I","R"                                                     
        integer,                        intent(out)  :: NG        ! Out -> Number of symmetry operators                                                   
        real(kind=sp),dimension(:,:),   intent(out)  :: TS        ! Out -> Translation parts of the symmetry operators                                    
        integer, dimension(:,:,:),      intent(out)  :: SS        ! Out -> Rotation parts of the symmetry operators                                       
        character (len=2),              intent(out)  :: latsy     ! Out -> Bravais lattice symbol                                                         
        character (len=20),             intent( in)  :: SpaceH    !  In -> H-M Spacegroup symbol                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get all the information contained in the H-M symbol.                                                                                    
    Routine to interpret Hermann-Mauguin symbol for space group.                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun5"  > Subroutine Get_Stabilizer(X,Spg,Order,Ptr) </a> </h4>                                                                          
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent (in)  :: x     ! real(kind=sp) space position (fractional coordinates)                                        
        type(Space_Group_type),      intent (in)  :: Spg   ! Space group                                                                                  
        integer,                     intent(out)  :: order ! Number of sym.op. keeping invariant the position x                                           
        integer, dimension(:),       intent(out)  :: ptr   ! Array pointing to the symmetry operators numbers                                             
                                                           ! of the stabilizer (point group) of x                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Soubroutine to obtain the list of symmetry operator of a space group that leaves                                                                      
    invariant an atomic position. This subroutine provides a pointer to the symmetry                                                                      
    operators of the site point group.                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun6"  > Subroutine Get_String_Resolv(T,X,Ix,Symb) </a> </h4>                                                                           
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent( in) :: t      !  In -> Traslation part                                                                       
        real(kind=sp), dimension(3), intent( in) :: x      !  In -> real(kind=sp) part of variable                                                        
        integer, dimension(3),       intent( in) :: ix     !  In -> Frags: 1:x, 2:y, 3:z                                                                  
        character (len=*),           intent(out) :: symb   ! Out -> String                                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Returning a string for point, axes or plane give as                                                                                                   
    written in fractional form from Resolv_sist procedures.                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun7"  > Subroutine Get_SubOrbits(X,Spg,ptr,Mult,orb,ind,conv) </a> </h4>                                                               
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3),  intent (in) :: x     !  In -> Position vector                                                                       
        type(Space_Group_type),       intent (in) :: spgr  !  In -> Space Group                                                                           
        integer,dimension(:),         intent( in) :: ptr   !  In -> Pointer to symops of a subgroup                                                       
        integer,                      intent(out) :: mult  !  Out -> Multiplicity                                                                         
        real, dimension(:,:),         intent(out) :: orb   !  Out -> List of equivalent positions                                                         
        integer,dimension(:),         intent(out) :: ind   !  Out -> Integer giving the number of the suborbits                                           
        character(len=*), optional,   intent( in) :: conv  !  In  -> If present centring transl. are considered                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity and list of equivalent positions                                                                                              
    modulo lattice translations (including centring!) of a                                                                                                
    position. When symmetry operators of a subgroup of Spg is given                                                                                       
    an index vector (ind) gives the division in subOrbits.                                                                                                
    The pointer ptr indicates the symmetry operators of Spg belonging                                                                                     
    to the subgroup. The first zero value of ptr terminates the search.                                                                                   
    If the optional argument "conv" is given the centring translations                                                                                    
    are considered. The orbits are formed by all atoms within a                                                                                           
    conventional unit cell. Otherwise the orbit is formed only with                                                                                       
    the content of a primitive cell.                                                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun8"  > Subroutine Get_Symel(Sim,Xyzstring) </a> </h4>                                                                                 
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent( in) :: sim         !  In -> Rotational part                                                                      
        character (len=*),       intent(out) :: XYZstring   ! Out -> String                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string with the "symmetry element" (I.T.) for the                                                                                          
    rotation matrix Sim. They correspond to the symbols given in                                                                                          
    I.T. for space groups Pm3m and P6/mmm.                                                                                                                
    Logical "hexa" must be defined                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun9"  > Subroutine Get_Symkov(Sim,Xyzstring) </a> </h4>                                                                                
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent( in) :: sim        !  In -> Rotational part                                                                       
        character (len=*),       intent(out) :: XYZstring                                                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string with the "symmetry element" (I.T.) for the rotation                                                                                 
    matrix Sim. They correspond to the symbols Kovalev.                                                                                                   
    Logical "hexa" must be defined                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun10" > Subroutine Get_SymSymb(Sim,Tt,Strsym) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        real(kind=sp)/integer, dimension(3,3), intent( in)    :: sim      !  In -> Rotational part of the S.O.                                            
        real(kind=sp), dimension( 3),          intent( in)    :: tt       !  In -> Translational part of the S.O.                                         
        character (len=*),                     intent(out)    :: Strsym   ! Out -> String in th form X,Y,-Z, ...                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the Jones Faithful representation of a symmetry operator                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun11" > Subroutine Get_T_SubGroups(SpG,SubG,nsg) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type) ,             intent( in) :: SpG                                                                                          
        type (Space_Group_Type) ,dimension(:),intent(out) :: SubG                                                                                         
        integer,                              intent(out) :: nsg                                                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to obtain the list of all non-trivial translationengleiche                                                                                 
    subgroups (t-subgroups) of a given space group. The unit cell setting                                                                                 
    is supposed to be the same as that of the input space group "SpG"                                                                                     
    The search of space sub-groups is performed using a systematic combination                                                                            
    of the symmetry operators of the group.                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun12" > Subroutine Init_Err_Symm() </a> </h4>                                                                                          
    <p>                                                                                                                                                   
                                                                                                                                                          
    Initialize the errors flags in this Module                                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun13" > Subroutine Inverse_Symm(R,T,S,U) </a> </h4>                                                                                    
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3),     intent(in)  :: R     !  In -> Rotational Part                                                                        
        real(kind=sp), dimension(3), intent(in)  :: t     !  In -> Traslational part                                                                      
        integer, dimension(3,3),     intent(out) :: S     ! Out -> New Rotational part                                                                    
        real(kind=sp), dimension(3), intent(out) :: u     ! Out -> new traslational part                                                                  
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculates the inverse of the symmetry operator (R,t)                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun14" > Subroutine Latsym(Symb,Numl,Latc) </a> </h4>                                                                                   
    <p> <pre>                                                                                                                                             
        character (len=*),                       intent(in)  :: SYMB  !  In -> Space Group H-M/Hall symbol                                                
        integer, optional,                       intent(in)  :: numL  !  Number of centring vectors                                                       
        real(kind=sp),optional, dimension(3,11), intent(in)  :: latc  !  Centering vectors                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    <p> <pre>                                                                                                                                             
            Inlat  Lattice type & associated translations                                                                                                 
              1     P: { 000 }                                                                                                                            
              2     A: { 000;  0  1/2 1/2 }+                                                                                                              
              3     B: { 000; 1/2  0  1/2 }+                                                                                                              
              4     C: { 000; 1/2 1/2  0  }+                                                                                                              
              5     I: { 000; 1/2 1/2 1/2 }+                                                                                                              
              6     R: { 000; 2/3 1/3 1/3; 1/3 2/3 2/3   } +                                                                                              
              7     F: { 000;  0  1/2 1/2; 1/2  0  1/2; 1/2 1/2  0 } +                                                                                    
              8     Z: { 000;  user-given centring vectors } +                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    Provides the Lattice type of the S.G. SYMB. Also gives the index (Inlat)                                                                              
    of the lattice, the multiplicity (Nlat) and the fractionnal lattice translations                                                                      
    ((Ltr(in,j)j=1,3),in=1,Nlat) and Lat_Type.                                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun15" > Subroutine Read_Msymm(Info,Sim,P_Mag) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        character (len=*),       intent( in) :: Info   !  In -> Input string with S.Op.                                                                   
                                                                in the form: MSYM  u,w,w,p_mag                                                            
        integer, dimension(3,3), intent(out) :: sim    ! Out -> Rotation matrix                                                                           
        real(kind=sp),           intent(out) :: p_mag  ! Out -> magnetic phase                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read magnetic symmetry operators in the form U,V,W, etc...                                                                                            
    Provides the magnetic rotational matrix and phase associated to a MSYM symbol                                                                         
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun16" > Subroutine Read_SymTrans_Code(Code,N,Tr) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        character (len=*),          intent( in) :: Code                                                                                                   
        integer,                    intent(out) :: N                                                                                                      
        real(kind=sp),dimension(3), intent(out) :: Tr                                                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read a Code string for reference the symmetry operator and the                                                                                        
    Traslation applied.                                                                                                                                   
    <p> <pre>                                                                                                                                             
            _2.555     : N_Op = 2, Tr=( 0.0, 0.0, 0.0)                                                                                                    
            _3.456     : N_Op = 3, Tr=(-1.0, 0.0, 1.0)                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun17" > Subroutine Read_Xsym(Info,Istart,Sim,Tt) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        character (len=*),                     intent( in)    :: Info   !  In -> String with the symmetry symbol                                          
                                                                                 in the form: SYMM  x,-y+1/2,z                                            
        integer,                               intent(in)     :: istart !  In -> Starting index of info to read in.                                       
        integer, dimension(3,3),               intent(out)    :: sim    ! Out -> Rotational part of S.O.                                                  
        real(kind=sp), optional, dimension(3), intent(out)    :: tt     ! Out -> Traslational part of S.O.                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read symmetry or transformation operators in the form X,Y,Z, etc...                                                                                   
    Provides the rotational matrix and translation associated a to SYMM symbol                                                                            
    in the Jones Faithful representation.                                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun18" > Subroutine Searchop(Sim,I1,I2,Isl) </a> </h4>                                                                                  
    <p> <pre>                                                                                                                                             
        integer , dimension(3,3), Intent(in)  :: sim      !  In -> Rotational part of a symmetry operator                                                 
        integer ,                 Intent(in)  :: i1       !  In -> i1=1,  i2=24  if not hexagonal  (matrices of m3m )                                     
        integer ,                 Intent(in)  :: i2       !  In -> i1=25, i2=36  if     hexagonal  (matrices of 6/mmm)                                    
        integer ,                 Intent(out) :: Isl      ! Out -> Index of the matrix Mod6(Isl,:,:)=sim.                                                 
                                                                   This index allow to get the corresponding tabulated symmetry symbol.                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun19" > Subroutine Set_Spacegroup(Spacegen, Spacegroup, Gen, Ngen, Mode, Force_Hall) </a> </h4>                                        
    <p> <pre>                                                                                                                                             
        character (len=*),                       intent(in)     :: SpaceGen     !  In -> String with Number, Hall or Hermman-Mauguin                      
        Type (Space_Group),                         intent(out) :: SpaceGroup   ! Out -> SpaceGroup variable                                              
        character (len=*), dimension(:),  intent(in ), optional :: gen          !  In -> String Generators                                                
        Integer,                          intent(in ), optional :: ngen         !  In -> Number of Generators                                             
        character (len=*),                intent(in ), optional :: Mode         !  In -> HMS, ITC, Hall, Gen, Fix                                         
        character (len=*),                intent(in ), optional :: force_hall   !  In -> f_hall (if present force generation from Hall)                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine that construct the object SpaceGroup from the H-M or Hall symbol.                                                                          
    Expand the set of operators including centre of symmetry and non integer                                                                              
    translations for centred cells.                                                                                                                       
    If the optional argument Gen is given, then Ngen and Mode="GEN" should be given.                                                                      
    If the optional argument mode="ITC", the space group will be generated using the                                                                      
    the generators given in the International Tables for the standard setting. In this                                                                    
    case the string in SpaceGen should correspond to the Hermann-Mauguin symbol.                                                                          
    If the optional argument mode="HMS","HALL" is given the string in SpaceGen                                                                            
    should correspond to the desired symbol.                                                                                                              
    If Gen,NGen and Mode are not given but force_hall="f_hall" is given, the generation                                                                   
    of the symmetry operators from the symbol of the space group is according to the Hall                                                                 
    symbol even if the provided symbol is of Hermann-Maugin type.                                                                                         
    The use of the different options give rise to different ordering of the symmetry                                                                      
    operators or different origins and settings for the same space group.                                                                                 
                                                                                                                                                          
                                                                                                                                                          
    Updated: February - 2005                                                                                                                              
                                                                                                                                                          
    Subroutine Set_SpG_Mult_Table(SpG,tab,complete)                                                                                                       
    Type(Space_Group_Type),    intent (in)    :: SpG                                                                                                      
    integer, dimension(:,:),   intent (out)   :: tab                                                                                                      
    logical, optional,         intent (in)    :: complete                                                                                                 
                                                                                                                                                          
    Subroutine to construct the multiplication table of the factor group of                                                                               
    a space group. Two operators are equal if they differ only in a lattice                                                                               
    translation. The multiplication table is a square matrix with integer                                                                                 
    numbers corresponding to the ordering of operators in the space group                                                                                 
    If "complete" is not present, or if complete=.false., we consider only                                                                                
    the symmetry operators corresponding to the "primitive" content of the                                                                                
    unit cell, so a maximun 48x48 matrix is needed to hold the table in this                                                                              
    case. If complete is present and .true., the full table is constructed.                                                                               
                                                                                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="fun20" > Subroutine Setting_Change(From_Syst,To_Syst,Spacegroup, Car_Sym, Icar_Sym) </a> </h4>                                          
    <p> <pre>                                                                                                                                             
        character(len=2),    intent(in)     :: From_Syst   !  In -> IT : International Tables                                                             
                                                                    ML : Miller & Love                                                                    
                                                                    KO : Kovalev                                                                          
                                                                    BC : Bradley & Cracknell                                                              
                                                                    ZA : Zack                                                                             
        character(len=2),    intent(in)     :: To_Syst     !  In -> (Idem to From_Syst)                                                                   
        type (Space_Group),  intent(in out) :: SpaceGroup  !  In ->                                                                                       
                                                             Out ->                                                                                       
        character(len=35),    intent(out)   :: car_sym     ! Out ->                                                                                       
        character(len=35),    intent(out)   :: icar_sym    ! Out ->                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Traslate From From_Syst to To_syst the set of symmetry operators                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub1"  > Subroutine Similar_Transf_Sg(Mat,Orig,Spg,Spgn,Matkind) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension (3,3),   intent( in)    :: Mat     ! Matrix transforming the basis                                                       
        real(kind=sp), dimension (  3),   intent( in)    :: orig    ! Coordinates of the new origin                                                       
        type (Space_Group_Type) ,         intent( in)    :: SpG     ! Initial space group                                                                 
        type (Space_Group_Type) ,         intent(out)    :: SpGn    ! Maximum subgroup of SpG                                                             
        character (len=*), optional,      intent( in)    :: matkind ! Type of the input matrix                                                            
        character (len=*), optional,      intent( in)    :: Fix_lat ! Fixing Lattice type                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to construct a space group "SpGn" that is a maximal subgroup                                                                               
    of the input space group "SpG" compatible with the transformation                                                                                     
    of the basis corresponding to the matrix "Mat" and the new origin "orig".                                                                             
    The transformed SpGn will have (if it is the case) conventional centring vectors.                                                                     
    If matkind is given and matkind="it"/"IT", the input matrix is given                                                                                  
    as in International Tables:                                                                                                                           
    <p> <pre>                                                                                                                                             
                                                                                                                                                          
                          (a' b' c') = (a b c) Mat                                                                                                        
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    If matkind is not given or if it is not equal to "it"/"IT" the input matrix                                                                           
    is the transpose of the International convention (column matrices for basis vectors)                                                                  
    The new space group is obtained using the properties of conventional Bravais                                                                          
    lattices and symmetry operators. Only the symmetry operators of the conventionnal                                                                     
    form are retained to construct the new space group. If the Hermann-Mauguin symbol                                                                     
    is not given, that means it correspond to a special setting. The Hall symbol is                                                                       
    always given.                                                                                                                                         
    The coordinates of the origin is always given with respect to the (a b c) basis.                                                                      
    If Fix_lat is given a conventional lattice centring, this is fixed irrespective                                                                       
    of the centring obtained by applying the similarity transformation. For instance                                                                      
    is Fix_lat="P" and the transformation implies new centring vectors or the input                                                                       
    group is centred, the generators with fraccional translations are removed from                                                                        
    the group. If Fix_lat="A" (or whatever) the program will add the corresponding                                                                        
    generators irrespective that the generator is in the original/transformed group.                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub2"  > Subroutine Sym_B_Relations(Op/Symb,B_Ind,B_Fac) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3),     intent (in) :: Op      !  In  -> Rotation Matrix                                                                     
        character(len=*),            intent (in) :: Symb    !  In  -> Symmetry string                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    integer, dimension(6),       intent(out) :: B_Ind   !  Out -> B Index                                                                                 
    real(kind=sp), dimension(6), intent(out) :: B_Fac   !  Out -> B Factor                                                                                
                                                                                                                                                          
    Symmetry relations among coefficients of the anisotropic temperature                                                                                  
    factor.                                                                                                                                               
                                                                                                                                                          
    Order for B is: B11 B22 B33 B12 B13 B23                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub3"  > Subroutine Sym_Prod_St(Syma,Symb,Symab,Modlat) </a> </h4>                                                                      
    <p> <pre>                                                                                                                                             
        character(len=*),         intent (in)  :: syma                                                                                                    
        character(len=*),         intent (in)  :: symb                                                                                                    
        character(len=len(syma)), intent (out) :: symab                                                                                                   
        logical, optional,        intent (in)  :: modlat                                                                                                  
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the symbol/Op/Matrix+trans of the  symmetry operation corresponding                                                                            
    to the product of two operators given in the Jone's Faithful(symbol)                                                                                  
    representation or in Symmetry Operator type.                                                                                                          
    <p> <pre>                                                                                                                                             
                                                                                                                                                          
         Op_a =  (Sa,ta) ;  Op_b =  (Sb,tb)                                                                                                               
                                                                                                                                                          
         Op_ab =  (Sa,ta) (Sb,tb)  = (Sa Sb,  Sa tb + ta)                                                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    If modlat=.true. or it is not present, the traslation                                                                                                 
    part of the resulting operator is reduced to have components < 1.0                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub4"  > Subroutine Symmetry_Symbol(Op,Symb), (S,T,Symb), (Symm,Symb) </a> </h4>                                                        
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_type),         intent (in) :: Op                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    integer, dimension(3,3),     intent (in) :: S                                                                                                         
    real(kind=sp), dimension(3), intent (in) :: t                                                                                                         
                                                                                                                                                          
    character(len=*),            intent (in) :: Symm                                                                                                      
                                                                                                                                                          
    character(len=*),            intent (out):: symb                                                                                                      
                                                                                                                                                          
    Obtain the symbol of the symmetry element of the operator Op                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub5"  > Subroutine Write_Spacegroup(Spacegroup,Iunit,Full) </a> </h4>                                                                  
    <p> <pre>                                                                                                                                             
        type (Space_Group),  intent(in)  :: SpaceGroup !  In -> SpaceGroup Variable                                                                       
        integer,  optional,  intent(in)  :: iunit      !  In -> Write information on Iunit                                                                
        logical,  optional,  intent(in)  :: full       !  In -> Full operator or not                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Writing in file of logical unit "lun" the characteristics of                                                                                          
    the space group "SpaceG". Part of the information contained                                                                                           
    in  SpaceGroup may be undefined, depending on the tabulated                                                                                           
    nature of the item. If full=.true. is present the whole group                                                                                         
    is output including the symmetry symbol associated to each                                                                                            
    operator.                                                                                                                                             
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub6"  > Subroutine Write_Sym(Lun,Indx,Sim,Tt,P_Mag,Mag) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        integer,                     intent(in) :: lun       !  In -> Logical unit of the file to write                                                   
        integer,dimension(3,3),      intent(in) :: sim       !  In -> Rotational part of the S.O.                                                         
        integer,                     intent(in) :: indx      !  In -> Ordinal of the current Symm.Operator                                                
        real(kind=sp), dimension(3), intent(in) :: tt        !  In -> Translation part of the S.O.                                                        
        real(kind=sp),               intent(in) :: p_mag     !  In -> Magnetic phase of the magnetic S.O.                                                 
        logical,                     intent(in) :: mag       !  In -> .true. if it is a magnetic S.O.                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Writing the reduced set of symmetry operators                                                                                                         
    Logical hexa must be defined (valid for conventional bases)                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub7"  > Subroutine Write_SymTrans_Code(N,Tr,Code) </a> </h4>                                                                           
    <p> <pre>                                                                                                                                             
        integer,                    intent(in)  :: N                                                                                                      
        real(kind=sp),dimension(3), intent(in)  :: Tr                                                                                                     
        character (len=*),          intent(out) :: Code                                                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Write the code string for reference the symmetry operator and the                                                                                     
    Traslation applied.                                                                                                                                   
    <p> <pre>                                                                                                                                             
            _2.555     : N_Op = 2, Tr=( 0.0, 0.0, 0.0)                                                                                                    
            _3.456     : N_Op = 3, Tr=(-1.0, 0.0, 1.0)                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub8"  > Subroutine Write_Wyckoff(Wyckoff,Spg_Name,Lun) </a> </h4>                                                                      
    <p> <pre>                                                                                                                                             
        type(wyckoff_type), intent(in) :: Wyckoff     !  In -> Wyckoff Type variable                                                                      
        character(len=*),   intent(in) :: Spg_Name    !  In -> SpaceGroup Name                                                                            
        integer,optional,   intent(in) :: Lun         !  In -> Unit to write the information                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Print/Write the Wyckoff positions in Lun unit                                                                                                         
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub9"  > Subroutine Wyckoff_Orbit(Spacegroup,Wyckoffstr,N_Orbit,Orbitstr) </a> </h4>                                                    
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type),       intent( in) :: SpaceGroup !  In -> SpaceGroup Variable                                                             
        character(len=*),              intent( in) :: WyckoffStr !  In -> Representative of the Orbit                                                     
        integer,                       intent(out) :: N_Orbit    ! Out -> Number of Components in the Orbit                                               
        character(len=*),dimension(:), intent(out) :: OrbitStr   ! Out -> Wyckoff Positions Strings                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculation of the Wyckoff positions from the representative element                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub11" > Copyleft(C) 1999-2005,              Version: 3.0 </a> </h4>                                                                    
    <p> <pre>                                                                                                                                             
     Juan Rodriguez-Carvajal & Javier Gonzalez-Platas                                                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    MODULE: CRYSTALLOGRAPHIC_SYMMETRY                                                                                                                     
    INFO: This module constains everything needed for handling symmetry                                                                                   
    in Crystallography. Part of the information is obtained from                                                                                          
    tabulated items in the module Symmetry_Tables. In particular                                                                                          
    the correspondence of non standard settings Hermann-Mauguin                                                                                           
    symbols and Hall symbols for space groups.                                                                                                            
    The generation of the public type Space_Group_Type is done                                                                                            
    using a variety of algorithms and methods.                                                                                                            
    Many procedures for handling symmetry (symbolic and algebraic)                                                                                        
    are provided in this module.                                                                                                                          
                                                                                                                                                          
    HISTORY                                                                                                                                               
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub12" > July    - 1999 Re-organised and updated by JGP and JRC. </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
                October - 1996 Created by JRC                                                                                                             
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    DEPENDENCIES                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
    VARIABLES                                                                                                                                             
    CUBIC                                                                                                                                                 
    ERR_MESS_SYMM                                                                                                                                         
    ERR_SYMM                                                                                                                                              
    HEXA                                                                                                                                                  
    HEXAG                                                                                                                                                 
    INLAT                                                                                                                                                 
    LAT_TYPE                                                                                                                                              
    LTR                                                                                                                                                   
    MONOC                                                                                                                                                 
    NLAT                                                                                                                                                  
    NUM_SPGR_INFO                                                                                                                                         
    ORTOR                                                                                                                                                 
    SPACEG                                                                                                                                                
    SYM_OPER_TYPE                                                                                                                                         
    WYCK_POS_TYPE                                                                                                                                         
    WYCKOFF_TYPE                                                                                                                                          
    SPACE_GROUP_TYPE                                                                                                                                      
    TETRA                                                                                                                                                 
    TRIGO                                                                                                                                                 
                                                                                                                                                          
    PROCEDURES                                                                                                                                            
    Functions:                                                                                                                                            
    APPLYSO                                                                                                                                               
    AXES_ROTATION                                                                                                                                         
    GET_LAUE_NUM                                                                                                                                          
    GET_MULTIP_POS                                                                                                                                        
    GET_OCC_SITE                                                                                                                                          
    GET_POINTGROUP_NUM                                                                                                                                    
    IS_NEW_OP                                                                                                                                             
    LATTICE_TRANS                                                                                                                                         
    SPGR_EQUAL                                                                                                                                            
    SYM_PROD                                                                                                                                              
                                                                                                                                                          
    Subroutines:                                                                                                                                          
    DECODMATMAG                                                                                                                                           
    GET_CENTRING_VECTORS                                                                                                                                  
    GET_CRYSTAL_SYSTEM                                                                                                                                    
    GET_HALLSYMB_FROM_GENER                                                                                                                               
    GET_LATTICE_TYPE                                                                                                                                      
    GET_LAUE_PG                                                                                                                                           
    GET_LAUE_STR                                                                                                                                          
    GET_ORBIT                                                                                                                                             
    GET_POINTGROUP_STR                                                                                                                                    
    GET_SO_FROM_FIX                                                                                                                                       
    GET_SO_FROM_GENER                                                                                                                                     
    GET_SO_FROM_HALL                                                                                                                                      
    GET_SO_FROM_HMS                                                                                                                                       
    GET_STABILIZER                                                                                                                                        
    GET_STRING_RESOLV                                                                                                                                     
    GET_SUBORBITS                                                                                                                                         
    GET_SYMEL                                                                                                                                             
    GET_SYMKOV                                                                                                                                            
    GET_SYMSYMB                                                                                                                                           
    GET_T_SUBGROUPS                                                                                                                                       
    INIT_ERR_SYMM                                                                                                                                         
    INVERSE_SYMM                                                                                                                                          
    LATSYM                                                                                                                                                
    READ_MSYMM                                                                                                                                            
    READ_SYMTRANS_CODE                                                                                                                                    
    READ_XSYM                                                                                                                                             
    SEARCHOP                                                                                                                                              
    SET_SPACEGROUP                                                                                                                                        
    SET_SPG_MULT_TABLE                                                                                                                                    
    SETTING_CHANGE                                                                                                                                        
    SIMILAR_TRANSF_SG                                                                                                                                     
    SYM_B_RELATIONS                                                                                                                                       
    SYM_PROD_ST                                                                                                                                           
    SYMMETRY_SYMBOL                                                                                                                                       
    WRITE_SPACEGROUP                                                                                                                                      
    WRITE_SYM                                                                                                                                             
    WRITE_SYMTRANS_CODE                                                                                                                                   
    WRITE_WYCKOFF                                                                                                                                         
    WYCKOFF_ORBIT                                                                                                                                         
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
    CUBIC                                                                                                                                                 
    integer, parameter, public :: Cubic                                                                                                                   
                                                                                                                                                          
    Cubic parameter index: Cubic = 554                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub13" > ERR_MESS_SYMM </a> </h4>                                                                                                       
    <p> <pre>                                                                                                                                             
        character(len=150), public :: Err_Mess_Symm                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    String containing information about the last error                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub14" > ERR_SYMM </a> </h4>                                                                                                            
    <p> <pre>                                                                                                                                             
        logical, public :: Err_Symm                                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Logical Variable to indicate an error on this module.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub15" > HEXA </a> </h4>                                                                                                                
    <p> <pre>                                                                                                                                             
        logical, public :: Hexa                                                                                                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    .false. Rotational part of symmetry operators  belongs to m3m                                                                                         
    .true.  Rotational part of symmetry operators  belongs to 6/mmm                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub16" > HEXAG </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Hexag                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for hexagonal Groups: Hexag  = 527                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub17" > INLAT </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, public        :: Inlat                                                                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Ordinal index of the lattice                                                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub18" > LAT_TYPE </a> </h4>                                                                                                            
    <p> <pre>                                                                                                                                             
        character(len= 1), public     :: Lat_type                                                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    First character of the space group symbol                                                                                                             
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub19" > LTR </a> </h4>                                                                                                                 
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3,10), public  :: Ltr                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Centering Lattice Translations, up to 10 lattice centring                                                                                             
    vectors are allowed. Conventional lattice centring need only 4 vectors                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub20" > MONOC </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Monoc                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Monoclinic Groups: Monoc  =  15                                                                                                   
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub21" > NLAT </a> </h4>                                                                                                                
    <p> <pre>                                                                                                                                             
        integer, public      :: Nlat                                                                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Multiplicity of the lattice                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub22" > NUM_SPGR_INFO </a> </h4>                                                                                                       
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Num_Spgr_Info                                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Total dimension of SPGR_INFO: Num_Spgr_Info = 612                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub23" > ORTOR </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Ortor                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Orthorhombic Groups: Ortor  = 163                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub24" > SPACEG </a> </h4>                                                                                                              
    <p> <pre>                                                                                                                                             
         character(len=20), public     :: SpaceG                                                                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Space group symbol                                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub25" > TYPE :: SYM_OPER_TYPE </a> </h4>                                                                                               
    <p> <pre>                                                                                                                                             
     Type, public :: Sym_Oper_Type                                                                                                                        
        integer,       dimension(3,3) :: Rot     !  Rotational Part of Symmetry Operator                                                                  
        real(kind=sp), dimension(3)   :: Tr      !  Traslational part of Symmetry Operator                                                                
     End Type  Sym_Oper_Type                                                                                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub26" > TYPE :: WYCK_POS_TYPE </a> </h4>                                                                                               
    <p> <pre>                                                                                                                                             
     Type, public :: Wyck_Pos_Type                                                                                                                        
        integer                         :: multp     ! Multiplicity                                                                                       
        character(len= 6)               :: site      ! Site Symmetry                                                                                      
        integer                         :: norb      ! Number of elements in orbit                                                                        
        character(len=40)               :: orig      ! Orig                                                                                               
        character(len=40),dimension(48) :: str_orbit ! Orbit                                                                                              
        character(len=40),dimension(192):: extra_orbit                                                                                                    
     End Type Wyck_Pos_Type                                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub27" > TYPE :: WYCKOFF_TYPE </a> </h4>                                                                                                
    <p> <pre>                                                                                                                                             
     Type, public :: Wyckoff_Type                                                                                                                         
        integer                            :: num_orbit      ! Number of orbits                                                                           
        type(wyck_pos_type), dimension(26) :: orbit          ! Orbit type                                                                                 
     End Type Wyckoff_Type                                                                                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of Variable                                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub28" > TYPE :: SPACE_GROUP_TYPE </a> </h4>                                                                                            
    <p> <pre>                                                                                                                                             
     Type, public :: Space_Group_Type                                                                                                                     
        Integer                            :: NumSpg        ! Number of the Space Group                                                                   
        Character(len=20)                  :: SPG_Symb      ! Hermann-Mauguin Symbol                                                                      
        Character(len=16)                  :: Hall          ! Hall symbol                                                                                 
        Character(len=12)                  :: CrystalSys    ! Crystal system                                                                              
        Character(len= 5)                  :: Laue          ! Laue Class                                                                                  
        Character(len= 5)                  :: PG            ! Point group                                                                                 
        Character(len= 5)                  :: Info          ! Extra information                                                                           
        Character(len=80)                  :: SG_setting    ! Information about the SG setting                                                            
                                                            ! (IT,KO,ML,ZA,Table,Standard,UnConventional)                                                 
        Logical                            :: Hexa          !                                                                                             
        Character(len= 1)                  :: SPG_lat       ! Lattice type                                                                                
        Character(len= 2)                  :: SPG_latsy     ! Lattice type Symbol                                                                         
        Integer                            :: NumLat        ! Number of lattice points in a cell                                                          
        real(kind=sp), dimension(3,12)     :: Latt_trans    ! Lattice translations                                                                        
        Character(len=51)                  :: Bravais       ! String with Bravais symbol + translations                                                   
        Character(len=80)                  :: Centre        ! Information about Centric or Acentric                                                       
        Integer                            :: Centred       ! =0 Centric(-1 no at origin)                                                                 
                                                            ! =1 Acentric                                                                                 
                                                            ! =2 Centric(-1 at origin)                                                                    
        real(kind=sp), dimension(3)        :: Centre_coord  ! Fractional coordinates of the inversion centre                                              
        Integer                            :: NumOps        ! Number of reduced set of S.O.                                                               
        Integer                            :: Multip        ! Multiplicity of the general position                                                        
        Integer                            :: Num_gen       ! Minimum number of operators to generate the Group                                           
        type(Sym_Oper_Type), dimension(192):: SymOp         ! Symmetry operators                                                                          
        Character(len=40), dimension(192)  :: SymopSymb     ! Strings form of symmetry operators                                                          
        type(wyckoff_type)                 :: Wyckoff       ! Wyckoff Information                                                                         
        real(kind=sp), dimension(3,2)      :: R_Asym_Unit   ! Asymmetric unit in real space                                                               
     End Type Space_Group_Type                                                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Definition of a variable type Space_Group_Type                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub29" > TETRA </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Tetra                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Tetragonal Groups: Tetra = 410                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub30" > TRIGO </a> </h4>                                                                                                               
    <p> <pre>                                                                                                                                             
        integer, parameter, public :: Trigo                                                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Index parameter for Trigonal Groups: Trigo = 495                                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub31" > Function Applyso(Op,V) Result(Applysop) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        Type(Sym_Oper_Type),          intent(in) :: Op        !  In -> Symmetry Operator Type                                                             
        real(kind=sp), dimension(3) , intent(in) :: v         !  In -> Vector                                                                             
        real(kind=sp), dimension(3)              :: ApplySOp  ! Out -> Output vector                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Apply a symmetry operator to a vector:  Vp = ApplySO(Op,v)                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub32" > Function Axes_Rotation(R) Result(N) </a> </h4>                                                                                 
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3,3), intent  (in) :: r    !  In -> Rotation part of Symmetry Operator                                                   
        integer                                     :: n    ! Out -> Orden of the Rotation Part                                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine the orden of rotation (valid for all bases). Return a zero                                                                                  
    if any error occurs.                                                                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub33" > Function Get_Laue_Num(Laueclass) Result(Lnum) </a> </h4>                                                                       
    <p> <pre>                                                                                                                                             
        character(len=*), intent (in) :: laueclass    !  In -> Laue Class string                                                                          
        integer                       :: lnum         ! Out -> Ordinal number according LAUE_CLASS                                                        
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the ordinal number corresponding to the Laue-Class                                                                                             
    symbol according to Laue_Class array. Zero if error is present                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub34" > Function Get_Multip_Pos(X,Spg) Result(Mult) </a> </h4>                                                                         
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent (in) :: x        !  In -> Position vector                                                                     
        type(Space_Group_type),      intent (in) :: spgr     !  In -> Space Group                                                                         
        integer                                  :: mult     !  Result -> Multiplicity                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity of a real space point given the space group.                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub35" > Function Get_Occ_Site(Pto,Spg) Result(Occ) </a> </h4>                                                                          
    <p> <pre>                                                                                                                                             
        real(kind=sp),dimension(3),intent (in) :: Pto ! Point for Occupancy calculation                                                                   
        Type (Space_Group_Type),   intent(in)  :: Spg ! Space Group                                                                                       
        real(kind=sp)                          :: Occ ! Result                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the occupancy factor (site multiplicity/multiplicity) for Pto                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub36" > Function Get_Pointgroup_Num(Pgname) Result(Ipg) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        character(len=*), intent (in) :: pgname        !  In -> String for PointGroup                                                                     
        integer                       :: ipg           ! Out -> Ordinal number as POINT_GROUP                                                             
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the ordinal number corresponding to the Point Group                                                                                            
    symbol according to Point_Group array. Zero if Error is present                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub37" > Logical Function Is_New_Op(Op,N,List_Op) Result(Is_New) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_type), intent(in)               :: op      !  In ->  Symmetry operator                                                              
        Integer,             intent(in)               :: n       !  In ->  Integer giving the number of Op i the list                                     
        type(Sym_Oper_type), intent(in), dimension(:) :: list_op !  In ->  List of n symmetry operators                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine if a symmetry operator is or not in a given list                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub38" > Logical Function Lattice_Trans(V,Lat) Result(Lattice_Transl) </a> </h4>                                                        
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent( in) :: v              !  In -> Vector                                                                        
        character(len=*),            intent( in) :: Lat            !  In -> Lattice Character                                                             
        logical                                  :: Lattice_Transl ! Out -> .True. or .False.                                                             
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine whether a vector is a lattice vector                                                                                                        
    depending on the Bravais lattice.                                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub39" > Logical Function Spgr_Equal(Spacegroup1,Spacegroup2) Result(Ispgr_Equal) </a> </h4>                                            
    <p> <pre>                                                                                                                                             
        Type (Space_Group_Type),  intent(in) :: SpaceGroup1   ! In ->                                                                                     
        Type (Space_Group_Type),  intent(in) :: SpaceGroup2   ! In ->                                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determine if two SpaceGroups are equal                                                                                                                
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub40" > Function Sym_Prod(Syma,Symb,Modlat) Result (Symab) </a> </h4>                                                                  
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_Type), intent (in) :: syma                                                                                                          
        type(Sym_Oper_Type), intent (in) :: symb                                                                                                          
        logical,optional,    intent (in) :: modlat                                                                                                        
        type(Sym_Oper_Type)              :: symab                                                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the symmetry operation corresponding to the product of                                                                                         
    two operators.                                                                                                                                        
    If modlat=.true. or it is not present, the traslation                                                                                                 
    part of the resulting operator is reduced to have components <1.0                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub41" > Subroutine Decodmatmag(Sim,Xyzstring) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent(in)  :: sim          !  In -> Rotation matrix                                                                     
        character (len=*),       intent(out) :: XYZstring    ! Out -> String (Mx,My,Mz)                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string of the form (Mx,My,Mz) for the rotation matrix Sim.                                                                                 
    Logical "hexa" must be defined.                                                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub42" > Subroutine Get_Centring_Vectors(L,Latc) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        integer,                        intent (in out) :: L     ! Number of centring vectors                                                             
        real(kind=sp), dimension(:,:),  intent (in out) :: latc  ! Centering vectors                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to complete the centring vectors of a centered lattice                                                                                     
    It is useful when non-conventional lattices are used.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub43" > Subroutine Get_Crystal_System(Ng, Ss / Gen, Isystm, Crys) </a> </h4>                                                           
    <p> <pre>                                                                                                                                             
        integer,                      intent(in) :: Ng     !  In -> Number of Operators (not related by                                                   
                                                                    inversion and lattice traslations)                                                    
        integer, dimension(:,:,:),    intent(in) :: Ss     !  In -> Rotation Part   (3,3,48)                                                              
        or                                                                                                                                                
        character(len=*),dimension(:),intent(in) :: gen    !  In -> Jones Faithful form of symmetry operators                                             
        integer,                      intent(out):: ISystm ! Out -> Number for Crystal System                                                             
                                                                     1: Triclinic       2: Monoclinic                                                     
                                                                     3: Orthorrombic    4: Tetragonal                                                     
                                                                     5: Trigonal        6: Hexagonal                                                      
                                                                     7: Cubic                                                                             
        character(len=1),             intent(out):: Crys   ! Out -> Symbol of Crystal family                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the number and string of the Crystal System from a set of operators                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub44" > Subroutine Get_HallSymb_From_Gener(Spacegroup, Spaceh) </a> </h4>                                                              
    <p> <pre>                                                                                                                                             
        type(Space_Group_Type),   intent(in out) :: SpaceGroup   !  In -> SpaceGroup type variable                                                        
                                                                   Out -> SpaceGroup type variable                                                        
        character(len=*), intent(out), optional  :: SpaceH       ! Out -> Hall Symbol                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determines the Hall symbol. In general this routine try to obtain                                                                                     
    the Hall symbol from generators so you need call Get_So_from_Gener                                                                                    
    before and call Set_Spgr_Info.                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub45" > Subroutine Get_Lattice_Type(L, Latc, Lattyp) </a> </h4>                                                                        
    <p> <pre>                                                                                                                                             
        integer,                        intent(in)  :: L         !  number of centring vectors                                                            
        real(kind=sp), dimension(:,:),  intent(in)  :: Latc      ! (3,11) centring vectors                                                                
        character(len=*),               intent(out) :: lattyp    ! Lattice symbol                                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get the lattice symbol from a set of centring vectors.                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub46" > Subroutine Get_Laue_Pg(Spacegroup, Laue_Car, Point_Car) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type),  intent( in) :: SpaceGroup   !  In -> Space Group type variable                                                          
        character(len=*),         intent(out) :: Laue_car     ! Out -> String with Laue symbol                                                            
        character(len=*),         intent(out) :: Point_car    ! Out -> String with Point Group symbol                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get the information of Laue and Point Group.                                                                                            
    Vvalid only for conventional bases for Point Group                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub47" > Subroutine Get_Laue_Str(Ilaue,Laue_Str) </a> </h4>                                                                             
    <p> <pre>                                                                                                                                             
        integer,          intent( in) :: ilaue         !  In -> Ordinal number in LAUE_CLASS                                                              
        character(len=*), intent(out) :: Laue_Str      ! Out -> String with the Laue class                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the string for the Laue-Class. Control of error is                                                                                             
    present                                                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub48" > Subroutine Get_Orbit(X,Spg,Mult,orb,ptr,str,prim) </a> </h4>                                                                   
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3),  intent (in) :: x     !  In -> Position vector                                                                       
        type(Space_Group_type),       intent (in) :: spgr  !  In -> Space Group                                                                           
        integer,                      intent(out) :: mult  !  Out -> Multiplicity                                                                         
        real, dimension(:,:),         intent(out) :: orb   !  Out -> List of equivalent positions                                                         
        integer,dimension(:),optional,intent(out) :: ptr   !  Out -> Pointer to effective symops                                                          
        integer,dimension(:),optional,intent(out) :: str   !  Out -> Pointer to stabilizer                                                                
        character(len=*),    optional,intent( in) :: prim  !  In  -> If given, only the primitive cell is considered                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity and list of equivalent positions                                                                                              
    (including centring!) modulo integer lattice translations.                                                                                            
    It provides also pointers to the stabilizer and to the                                                                                                
    symmetry operators changing effectively the position.                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub49" > Subroutine Get_Pointgroup_Str(Ipg,Str) </a> </h4>                                                                              
    <p> <pre>                                                                                                                                             
        integer,          intent( in) :: ipg        !  In -> Ordinal number for POINT_GROUP                                                               
        character(len=*), intent(out) :: Str        ! Out -> String for Point Group                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the string for the Point Group. Error control is present                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub50" > Subroutine Get_So_From_Fix(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Spacegen) </a> </h4>                                         
    <p> <pre>                                                                                                                                             
        integer,                     intent(out) :: ISYSTM    ! Out -> Number of the crystalline system                                                   
                                                              ! Out    (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                            
        integer,                     intent(out) :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                       
                                                                       1 Acentric                                                                         
                                                                       2 Centric (-1 at origin)                                                           
        integer,                     intent(out) :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                                  
                                                                       1   2   3   4   5   6   7   8                                                      
                                                                       "P","A","B","C","I","R","F","Z"                                                    
        integer,                     intent(in ) :: NG        !  In -> Number of symmetry operators                                                       
        real(kind=sp),dimension(:,:),intent(in ) :: TS        !  In -> Translation parts of the symmetry operators(3,48)                                  
        integer, dimension(:,:,:),   intent(in ) :: SS        !  In -> Rotation parts of the symmetry operators (3,3,48)                                  
        character (len=2),           intent(out) :: latsy     ! Out -> Bravais Lattice symbol                                                             
        real(kind=sp),dimension(3)  ,intent(out) :: Co        ! Out -> Coordinates of origin                                                              
        character (len=1),           intent(out) :: SpaceGen  ! Out -> Type of Cell                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Determines some of items of the object Space_Group_Type from FIXed                                                                                    
    symmetry operators given by user.                                                                                                                     
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub51" > Subroutine Get_So_From_Gener(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Num_G,Spacegen) </a> </h4>                                 
    <p> <pre>                                                                                                                                             
        integer,                      intent(out)   :: ISYSTM    ! Out -> Number of the crystalline system                                                
                                                                          (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                         
        integer,                      intent(out)   :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                    
                                                                          1 Acentric                                                                      
                                                                          2 Centric (-1 at origin)                                                        
        integer,                      intent(out)   :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                               
                                                                          1   2   3   4   5   6   7   8                                                   
                                                                          "P","A","B","C","I","R","F","Z"                                                 
        integer,                      intent(in out):: NG        !  In -> Number of defined generators                                                    
                                                                 ! Out -> Number of symmetry operators                                                    
        integer, dimension(:,:,:),    intent(in out):: SS        !  In -> Rotation parts of the given generators  (3,3,48)                                
                                                                 ! Out -> Rotation parts of the symmetry operators                                        
        real(kind=sp),dimension(:,:), intent(in out):: TS        !  In -> Translation parts of the given generators  (3,48)                               
                                                                 ! Out -> Translation parts of the symmetry operators                                     
        character (len=2),            intent(out)   :: latsy     ! Out -> Bravais Lattice symbol                                                          
        real(kind=sp),dimension(3),   intent(out)   :: Co        ! Out -> Coordinates of origin                                                           
        integer,                      intent(out)   :: Num_g     ! Out -> Minimum number of generators                                                    
        character (len=1),            intent(out)   :: SpaceGen  ! Out -> Type of Cell                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculates the whole set of symmetry operators from a set of given generators.                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub52" > Subroutine Get_So_From_Hall(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Co,Num_G,Hall) </a> </h4>                                      
    <p> <pre>                                                                                                                                             
        integer,                   intent(out)  :: ISYSTM    ! Out -> Number of the crystalline system                                                    
                                                                      (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                             
        integer,                   intent(out)  :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                        
                                                                      1 Acentric                                                                          
                                                                      2 Centric (-1 at origin)                                                            
        integer,                   intent(out)  :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                                   
                                                                      1   2   3   4   5   6   7                                                           
                                                                     "P","A","B","C","I","R","F"                                                          
        integer,                   intent(out)  :: NG        ! Out -> Number of symmetry operators                                                        
        real(kind=sp),    dimension(:,:),   intent(out)  :: TS        ! Out -> Translation parts of the symmetry operators  (3,48)                        
        integer, dimension(:,:,:), intent(out)  :: SS        ! Out -> Rotation parts of the symmetry operators     (3,3,48)                               
        character (len=2),         intent(out)  :: latsy     ! Out -> Bravais lattice symbol                                                              
        real(kind=sp), dimension(3),        intent(out)  :: Co        ! Out -> Coordinates of symmetry center                                             
        integer,                   intent(out)  :: num_g     ! Out -> Number of generators                                                                
        character (len=20),        intent( in)  :: Hall      !  In -> Hall Spacegroup symbol                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get all the information contained in the Hall symbol. This                                                                              
    routine to interpret the Hall symbol for a space group.                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub53" > Subroutine Get_So_From_Hms(Isystm,Isymce,Ibravl,Ng,Ss,Ts,Latsy,Spaceh) </a> </h4>                                              
    <p> <pre>                                                                                                                                             
        integer,                        intent(out)  :: ISYSTM    ! Out -> Number of the crystalline system                                               
                                                                           (1:T, 2:M, 3:O, 4:T, 5:R-Trg, 6:H, 7:C)                                        
        integer,                        intent(out)  :: ISYMCE    ! Out -> 0 Centric (-1 not at origin)                                                   
                                                                           1 Acentric                                                                     
                                                                           2 Centric (-1 at origin)                                                       
        integer,                        intent(out)  :: IBRAVL    ! Out -> Index of the Bravais Lattice type                                              
                                                                           1   2   3   4   5   6   7                                                      
                                                                          "P","A","B","C","F","I","R"                                                     
        integer,                        intent(out)  :: NG        ! Out -> Number of symmetry operators                                                   
        real(kind=sp),dimension(:,:),   intent(out)  :: TS        ! Out -> Translation parts of the symmetry operators                                    
        integer, dimension(:,:,:),      intent(out)  :: SS        ! Out -> Rotation parts of the symmetry operators                                       
        character (len=2),              intent(out)  :: latsy     ! Out -> Bravais lattice symbol                                                         
        character (len=20),             intent( in)  :: SpaceH    !  In -> H-M Spacegroup symbol                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to get all the information contained in the H-M symbol.                                                                                    
    Routine to interpret Hermann-Mauguin symbol for space group.                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub54" > Subroutine Get_Stabilizer(X,Spg,Order,Ptr) </a> </h4>                                                                          
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent (in)  :: x     ! real(kind=sp) space position (fractional coordinates)                                        
        type(Space_Group_type),      intent (in)  :: Spg   ! Space group                                                                                  
        integer,                     intent(out)  :: order ! Number of sym.op. keeping invariant the position x                                           
        integer, dimension(:),       intent(out)  :: ptr   ! Array pointing to the symmetry operators numbers                                             
                                                           ! of the stabilizer (point group) of x                                                         
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Soubroutine to obtain the list of symmetry operator of a space group that leaves                                                                      
    invariant an atomic position. This subroutine provides a pointer to the symmetry                                                                      
    operators of the site point group.                                                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub55" > Subroutine Get_String_Resolv(T,X,Ix,Symb) </a> </h4>                                                                           
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3), intent( in) :: t      !  In -> Traslation part                                                                       
        real(kind=sp), dimension(3), intent( in) :: x      !  In -> real(kind=sp) part of variable                                                        
        integer, dimension(3),       intent( in) :: ix     !  In -> Frags: 1:x, 2:y, 3:z                                                                  
        character (len=*),           intent(out) :: symb   ! Out -> String                                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Returning a string for point, axes or plane give as                                                                                                   
    written in fractional form from Resolv_sist procedures.                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub56" > Subroutine Get_SubOrbits(X,Spg,ptr,Mult,orb,ind,conv) </a> </h4>                                                               
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension(3),  intent (in) :: x     !  In -> Position vector                                                                       
        type(Space_Group_type),       intent (in) :: spgr  !  In -> Space Group                                                                           
        integer,dimension(:),         intent( in) :: ptr   !  In -> Pointer to symops of a subgroup                                                       
        integer,                      intent(out) :: mult  !  Out -> Multiplicity                                                                         
        real, dimension(:,:),         intent(out) :: orb   !  Out -> List of equivalent positions                                                         
        integer,dimension(:),         intent(out) :: ind   !  Out -> Integer giving the number of the suborbits                                           
        character(len=*), optional,   intent( in) :: conv  !  In  -> If present centring transl. are considered                                           
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the multiplicity and list of equivalent positions                                                                                              
    modulo lattice translations (including centring!) of a                                                                                                
    position. When symmetry operators of a subgroup of Spg is given                                                                                       
    an index vector (ind) gives the division in subOrbits.                                                                                                
    The pointer ptr indicates the symmetry operators of Spg belonging                                                                                     
    to the subgroup. The first zero value of ptr terminates the search.                                                                                   
    If the optional argument "conv" is given the centring translations                                                                                    
    are considered. The orbits are formed by all atoms within a                                                                                           
    conventional unit cell. Otherwise the orbit is formed only with                                                                                       
    the content of a primitive cell.                                                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub57" > Subroutine Get_Symel(Sim,Xyzstring) </a> </h4>                                                                                 
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent( in) :: sim         !  In -> Rotational part                                                                      
        character (len=*),       intent(out) :: XYZstring   ! Out -> String                                                                               
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string with the "symmetry element" (I.T.) for the                                                                                          
    rotation matrix Sim. They correspond to the symbols given in                                                                                          
    I.T. for space groups Pm3m and P6/mmm.                                                                                                                
    Logical "hexa" must be defined                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub58" > Subroutine Get_Symkov(Sim,Xyzstring) </a> </h4>                                                                                
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3), intent( in) :: sim        !  In -> Rotational part                                                                       
        character (len=*),       intent(out) :: XYZstring                                                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Supplies a string with the "symmetry element" (I.T.) for the rotation                                                                                 
    matrix Sim. They correspond to the symbols Kovalev.                                                                                                   
    Logical "hexa" must be defined                                                                                                                        
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub59" > Subroutine Get_SymSymb(Sim,Tt,Strsym) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        real(kind=sp)/integer, dimension(3,3), intent( in)    :: sim      !  In -> Rotational part of the S.O.                                            
        real(kind=sp), dimension( 3),          intent( in)    :: tt       !  In -> Translational part of the S.O.                                         
        character (len=*),                     intent(out)    :: Strsym   ! Out -> String in th form X,Y,-Z, ...                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the Jones Faithful representation of a symmetry operator                                                                                       
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub60" > Subroutine Get_T_SubGroups(SpG,SubG,nsg) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type) ,             intent( in) :: SpG                                                                                          
        type (Space_Group_Type) ,dimension(:),intent(out) :: SubG                                                                                         
        integer,                              intent(out) :: nsg                                                                                          
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to obtain the list of all non-trivial translationengleiche                                                                                 
    subgroups (t-subgroups) of a given space group. The unit cell setting                                                                                 
    is supposed to be the same as that of the input space group "SpG"                                                                                     
    The search of space sub-groups is performed using a systematic combination                                                                            
    of the symmetry operators of the group.                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub61" > Subroutine Init_Err_Symm() </a> </h4>                                                                                          
    <p>                                                                                                                                                   
                                                                                                                                                          
    Initialize the errors flags in this Module                                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub62" > Subroutine Inverse_Symm(R,T,S,U) </a> </h4>                                                                                    
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3),     intent(in)  :: R     !  In -> Rotational Part                                                                        
        real(kind=sp), dimension(3), intent(in)  :: t     !  In -> Traslational part                                                                      
        integer, dimension(3,3),     intent(out) :: S     ! Out -> New Rotational part                                                                    
        real(kind=sp), dimension(3), intent(out) :: u     ! Out -> new traslational part                                                                  
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculates the inverse of the symmetry operator (R,t)                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub63" > Subroutine Latsym(Symb,Numl,Latc) </a> </h4>                                                                                   
    <p> <pre>                                                                                                                                             
        character (len=*),                       intent(in)  :: SYMB  !  In -> Space Group H-M/Hall symbol                                                
        integer, optional,                       intent(in)  :: numL  !  Number of centring vectors                                                       
        real(kind=sp),optional, dimension(3,11), intent(in)  :: latc  !  Centering vectors                                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    <p> <pre>                                                                                                                                             
            Inlat  Lattice type & associated translations                                                                                                 
              1     P: { 000 }                                                                                                                            
              2     A: { 000;  0  1/2 1/2 }+                                                                                                              
              3     B: { 000; 1/2  0  1/2 }+                                                                                                              
              4     C: { 000; 1/2 1/2  0  }+                                                                                                              
              5     I: { 000; 1/2 1/2 1/2 }+                                                                                                              
              6     R: { 000; 2/3 1/3 1/3; 1/3 2/3 2/3   } +                                                                                              
              7     F: { 000;  0  1/2 1/2; 1/2  0  1/2; 1/2 1/2  0 } +                                                                                    
              8     Z: { 000;  user-given centring vectors } +                                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    Provides the Lattice type of the S.G. SYMB. Also gives the index (Inlat)                                                                              
    of the lattice, the multiplicity (Nlat) and the fractionnal lattice translations                                                                      
    ((Ltr(in,j)j=1,3),in=1,Nlat) and Lat_Type.                                                                                                            
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub64" > Subroutine Read_Msymm(Info,Sim,P_Mag) </a> </h4>                                                                               
    <p> <pre>                                                                                                                                             
        character (len=*),       intent( in) :: Info   !  In -> Input string with S.Op.                                                                   
                                                                in the form: MSYM  u,w,w,p_mag                                                            
        integer, dimension(3,3), intent(out) :: sim    ! Out -> Rotation matrix                                                                           
        real(kind=sp),           intent(out) :: p_mag  ! Out -> magnetic phase                                                                            
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read magnetic symmetry operators in the form U,V,W, etc...                                                                                            
    Provides the magnetic rotational matrix and phase associated to a MSYM symbol                                                                         
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub65" > Subroutine Read_SymTrans_Code(Code,N,Tr) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        character (len=*),          intent( in) :: Code                                                                                                   
        integer,                    intent(out) :: N                                                                                                      
        real(kind=sp),dimension(3), intent(out) :: Tr                                                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read a Code string for reference the symmetry operator and the                                                                                        
    Traslation applied.                                                                                                                                   
    <p> <pre>                                                                                                                                             
            _2.555     : N_Op = 2, Tr=( 0.0, 0.0, 0.0)                                                                                                    
            _3.456     : N_Op = 3, Tr=(-1.0, 0.0, 1.0)                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub66" > Subroutine Read_Xsym(Info,Istart,Sim,Tt) </a> </h4>                                                                            
    <p> <pre>                                                                                                                                             
        character (len=*),                     intent( in)    :: Info   !  In -> String with the symmetry symbol                                          
                                                                                 in the form: SYMM  x,-y+1/2,z                                            
        integer,                               intent(in)     :: istart !  In -> Starting index of info to read in.                                       
        integer, dimension(3,3),               intent(out)    :: sim    ! Out -> Rotational part of S.O.                                                  
        real(kind=sp), optional, dimension(3), intent(out)    :: tt     ! Out -> Traslational part of S.O.                                                
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Read symmetry or transformation operators in the form X,Y,Z, etc...                                                                                   
    Provides the rotational matrix and translation associated a to SYMM symbol                                                                            
    in the Jones Faithful representation.                                                                                                                 
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub67" > Subroutine Searchop(Sim,I1,I2,Isl) </a> </h4>                                                                                  
    <p> <pre>                                                                                                                                             
        integer , dimension(3,3), Intent(in)  :: sim      !  In -> Rotational part of a symmetry operator                                                 
        integer ,                 Intent(in)  :: i1       !  In -> i1=1,  i2=24  if not hexagonal  (matrices of m3m )                                     
        integer ,                 Intent(in)  :: i2       !  In -> i1=25, i2=36  if     hexagonal  (matrices of 6/mmm)                                    
        integer ,                 Intent(out) :: Isl      ! Out -> Index of the matrix Mod6(Isl,:,:)=sim.                                                 
                                                                   This index allow to get the corresponding tabulated symmetry symbol.                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub68" > Subroutine Set_Spacegroup(Spacegen, Spacegroup, Gen, Ngen, Mode, Force_Hall) </a> </h4>                                        
    <p> <pre>                                                                                                                                             
        character (len=*),                       intent(in)     :: SpaceGen     !  In -> String with Number, Hall or Hermman-Mauguin                      
        Type (Space_Group),                         intent(out) :: SpaceGroup   ! Out -> SpaceGroup variable                                              
        character (len=*), dimension(:),  intent(in ), optional :: gen          !  In -> String Generators                                                
        Integer,                          intent(in ), optional :: ngen         !  In -> Number of Generators                                             
        character (len=*),                intent(in ), optional :: Mode         !  In -> HMS, ITC, Hall, Gen, Fix                                         
        character (len=*),                intent(in ), optional :: force_hall   !  In -> f_hall (if present force generation from Hall)                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine that construct the object SpaceGroup from the H-M or Hall symbol.                                                                          
    Expand the set of operators including centre of symmetry and non integer                                                                              
    translations for centred cells.                                                                                                                       
    If the optional argument Gen is given, then Ngen and Mode="GEN" should be given.                                                                      
    If the optional argument mode="ITC", the space group will be generated using the                                                                      
    the generators given in the International Tables for the standard setting. In this                                                                    
    case the string in SpaceGen should correspond to the Hermann-Mauguin symbol.                                                                          
    If the optional argument mode="HMS","HALL" is given the string in SpaceGen                                                                            
    should correspond to the desired symbol.                                                                                                              
    If Gen,NGen and Mode are not given but force_hall="f_hall" is given, the generation                                                                   
    of the symmetry operators from the symbol of the space group is according to the Hall                                                                 
    symbol even if the provided symbol is of Hermann-Maugin type.                                                                                         
    The use of the different options give rise to different ordering of the symmetry                                                                      
    operators or different origins and settings for the same space group.                                                                                 
                                                                                                                                                          
                                                                                                                                                          
    Updated: February - 2005                                                                                                                              
                                                                                                                                                          
    Subroutine Set_SpG_Mult_Table(SpG,tab,complete)                                                                                                       
    Type(Space_Group_Type),    intent (in)    :: SpG                                                                                                      
    integer, dimension(:,:),   intent (out)   :: tab                                                                                                      
    logical, optional,         intent (in)    :: complete                                                                                                 
                                                                                                                                                          
    Subroutine to construct the multiplication table of the factor group of                                                                               
    a space group. Two operators are equal if they differ only in a lattice                                                                               
    translation. The multiplication table is a square matrix with integer                                                                                 
    numbers corresponding to the ordering of operators in the space group                                                                                 
    If "complete" is not present, or if complete=.false., we consider only                                                                                
    the symmetry operators corresponding to the "primitive" content of the                                                                                
    unit cell, so a maximun 48x48 matrix is needed to hold the table in this                                                                              
    case. If complete is present and .true., the full table is constructed.                                                                               
                                                                                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub69" > Subroutine Setting_Change(From_Syst,To_Syst,Spacegroup, Car_Sym, Icar_Sym) </a> </h4>                                          
    <p> <pre>                                                                                                                                             
        character(len=2),    intent(in)     :: From_Syst   !  In -> IT : International Tables                                                             
                                                                    ML : Miller & Love                                                                    
                                                                    KO : Kovalev                                                                          
                                                                    BC : Bradley & Cracknell                                                              
                                                                    ZA : Zack                                                                             
        character(len=2),    intent(in)     :: To_Syst     !  In -> (Idem to From_Syst)                                                                   
        type (Space_Group),  intent(in out) :: SpaceGroup  !  In ->                                                                                       
                                                             Out ->                                                                                       
        character(len=35),    intent(out)   :: car_sym     ! Out ->                                                                                       
        character(len=35),    intent(out)   :: icar_sym    ! Out ->                                                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Traslate From From_Syst to To_syst the set of symmetry operators                                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub70" > Subroutine Similar_Transf_Sg(Mat,Orig,Spg,Spgn,Matkind) </a> </h4>                                                             
    <p> <pre>                                                                                                                                             
        real(kind=sp), dimension (3,3),   intent( in)    :: Mat     ! Matrix transforming the basis                                                       
        real(kind=sp), dimension (  3),   intent( in)    :: orig    ! Coordinates of the new origin                                                       
        type (Space_Group_Type) ,         intent( in)    :: SpG     ! Initial space group                                                                 
        type (Space_Group_Type) ,         intent(out)    :: SpGn    ! Maximum subgroup of SpG                                                             
        character (len=*), optional,      intent( in)    :: matkind ! Type of the input matrix                                                            
        character (len=*), optional,      intent( in)    :: Fix_lat ! Fixing Lattice type                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Subroutine to construct a space group "SpGn" that is a maximal subgroup                                                                               
    of the input space group "SpG" compatible with the transformation                                                                                     
    of the basis corresponding to the matrix "Mat" and the new origin "orig".                                                                             
    The transformed SpGn will have (if it is the case) conventional centring vectors.                                                                     
    If matkind is given and matkind="it"/"IT", the input matrix is given                                                                                  
    as in International Tables:                                                                                                                           
    <p> <pre>                                                                                                                                             
                                                                                                                                                          
                          (a' b' c') = (a b c) Mat                                                                                                        
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    If matkind is not given or if it is not equal to "it"/"IT" the input matrix                                                                           
    is the transpose of the International convention (column matrices for basis vectors)                                                                  
    The new space group is obtained using the properties of conventional Bravais                                                                          
    lattices and symmetry operators. Only the symmetry operators of the conventionnal                                                                     
    form are retained to construct the new space group. If the Hermann-Mauguin symbol                                                                     
    is not given, that means it correspond to a special setting. The Hall symbol is                                                                       
    always given.                                                                                                                                         
    The coordinates of the origin is always given with respect to the (a b c) basis.                                                                      
    If Fix_lat is given a conventional lattice centring, this is fixed irrespective                                                                       
    of the centring obtained by applying the similarity transformation. For instance                                                                      
    is Fix_lat="P" and the transformation implies new centring vectors or the input                                                                       
    group is centred, the generators with fraccional translations are removed from                                                                        
    the group. If Fix_lat="A" (or whatever) the program will add the corresponding                                                                        
    generators irrespective that the generator is in the original/transformed group.                                                                      
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub71" > Subroutine Sym_B_Relations(Op/Symb,B_Ind,B_Fac) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        integer, dimension(3,3),     intent (in) :: Op      !  In  -> Rotation Matrix                                                                     
        character(len=*),            intent (in) :: Symb    !  In  -> Symmetry string                                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    integer, dimension(6),       intent(out) :: B_Ind   !  Out -> B Index                                                                                 
    real(kind=sp), dimension(6), intent(out) :: B_Fac   !  Out -> B Factor                                                                                
                                                                                                                                                          
    Symmetry relations among coefficients of the anisotropic temperature                                                                                  
    factor.                                                                                                                                               
                                                                                                                                                          
    Order for B is: B11 B22 B33 B12 B13 B23                                                                                                               
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub72" > Subroutine Sym_Prod_St(Syma,Symb,Symab,Modlat) </a> </h4>                                                                      
    <p> <pre>                                                                                                                                             
        character(len=*),         intent (in)  :: syma                                                                                                    
        character(len=*),         intent (in)  :: symb                                                                                                    
        character(len=len(syma)), intent (out) :: symab                                                                                                   
        logical, optional,        intent (in)  :: modlat                                                                                                  
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Obtain the symbol/Op/Matrix+trans of the  symmetry operation corresponding                                                                            
    to the product of two operators given in the Jone's Faithful(symbol)                                                                                  
    representation or in Symmetry Operator type.                                                                                                          
    <p> <pre>                                                                                                                                             
                                                                                                                                                          
         Op_a =  (Sa,ta) ;  Op_b =  (Sb,tb)                                                                                                               
                                                                                                                                                          
         Op_ab =  (Sa,ta) (Sb,tb)  = (Sa Sb,  Sa tb + ta)                                                                                                 
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    If modlat=.true. or it is not present, the traslation                                                                                                 
    part of the resulting operator is reduced to have components < 1.0                                                                                    
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub73" > Subroutine Symmetry_Symbol(Op,Symb), (S,T,Symb), (Symm,Symb) </a> </h4>                                                        
    <p> <pre>                                                                                                                                             
        type(Sym_Oper_type),         intent (in) :: Op                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    integer, dimension(3,3),     intent (in) :: S                                                                                                         
    real(kind=sp), dimension(3), intent (in) :: t                                                                                                         
                                                                                                                                                          
    character(len=*),            intent (in) :: Symm                                                                                                      
                                                                                                                                                          
    character(len=*),            intent (out):: symb                                                                                                      
                                                                                                                                                          
    Obtain the symbol of the symmetry element of the operator Op                                                                                          
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub74" > Subroutine Write_Spacegroup(Spacegroup,Iunit,Full) </a> </h4>                                                                  
    <p> <pre>                                                                                                                                             
        type (Space_Group),  intent(in)  :: SpaceGroup !  In -> SpaceGroup Variable                                                                       
        integer,  optional,  intent(in)  :: iunit      !  In -> Write information on Iunit                                                                
        logical,  optional,  intent(in)  :: full       !  In -> Full operator or not                                                                      
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Writing in file of logical unit "lun" the characteristics of                                                                                          
    the space group "SpaceG". Part of the information contained                                                                                           
    in  SpaceGroup may be undefined, depending on the tabulated                                                                                           
    nature of the item. If full=.true. is present the whole group                                                                                         
    is output including the symmetry symbol associated to each                                                                                            
    operator.                                                                                                                                             
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub75" > Subroutine Write_Sym(Lun,Indx,Sim,Tt,P_Mag,Mag) </a> </h4>                                                                     
    <p> <pre>                                                                                                                                             
        integer,                     intent(in) :: lun       !  In -> Logical unit of the file to write                                                   
        integer,dimension(3,3),      intent(in) :: sim       !  In -> Rotational part of the S.O.                                                         
        integer,                     intent(in) :: indx      !  In -> Ordinal of the current Symm.Operator                                                
        real(kind=sp), dimension(3), intent(in) :: tt        !  In -> Translation part of the S.O.                                                        
        real(kind=sp),               intent(in) :: p_mag     !  In -> Magnetic phase of the magnetic S.O.                                                 
        logical,                     intent(in) :: mag       !  In -> .true. if it is a magnetic S.O.                                                     
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Writing the reduced set of symmetry operators                                                                                                         
    Logical hexa must be defined (valid for conventional bases)                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub76" > Subroutine Write_SymTrans_Code(N,Tr,Code) </a> </h4>                                                                           
    <p> <pre>                                                                                                                                             
        integer,                    intent(in)  :: N                                                                                                      
        real(kind=sp),dimension(3), intent(in)  :: Tr                                                                                                     
        character (len=*),          intent(out) :: Code                                                                                                   
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Write the code string for reference the symmetry operator and the                                                                                     
    Traslation applied.                                                                                                                                   
    <p> <pre>                                                                                                                                             
            _2.555     : N_Op = 2, Tr=( 0.0, 0.0, 0.0)                                                                                                    
            _3.456     : N_Op = 3, Tr=(-1.0, 0.0, 1.0)                                                                                                    
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub77" > Subroutine Write_Wyckoff(Wyckoff,Spg_Name,Lun) </a> </h4>                                                                      
    <p> <pre>                                                                                                                                             
        type(wyckoff_type), intent(in) :: Wyckoff     !  In -> Wyckoff Type variable                                                                      
        character(len=*),   intent(in) :: Spg_Name    !  In -> SpaceGroup Name                                                                            
        integer,optional,   intent(in) :: Lun         !  In -> Unit to write the information                                                              
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Print/Write the Wyckoff positions in Lun unit                                                                                                         
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
    <h4> <a name="sub78" > Subroutine Wyckoff_Orbit(Spacegroup,Wyckoffstr,N_Orbit,Orbitstr) </a> </h4>                                                    
    <p> <pre>                                                                                                                                             
        type (Space_Group_Type),       intent( in) :: SpaceGroup !  In -> SpaceGroup Variable                                                             
        character(len=*),              intent( in) :: WyckoffStr !  In -> Representative of the Orbit                                                     
        integer,                       intent(out) :: N_Orbit    ! Out -> Number of Components in the Orbit                                               
        character(len=*),dimension(:), intent(out) :: OrbitStr   ! Out -> Wyckoff Positions Strings                                                       
                                                                                                                                                          
    </pre> </p>                                                                                                                                           
    <p>                                                                                                                                                   
    Calculation of the Wyckoff positions from the representative element                                                                                  
                                                                                                                                                          
    </p>                                                                                                                                                  
     <a href="#Mod17"> [Top Document] </a>                                                                                                                
    <hr size="1" noshade>                                                                                                                                 
  </body>
</html>
